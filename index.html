<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Árbol de Amor Animado - Unificado</title>
  <meta name="author" content="Zero" />
  <meta name="copyright" content="Zero - Código libre no comercial" />
  <meta name="description" content="Árbol de Amor Animado: una sorpresa interactiva y romántica para dedicar a tu pareja o ser querido. Código libre para uso personal, educativo o de inspiración." />
  <meta name="keywords" content="amor, sorpresa, romántico, dedicatoria, animación, árbol, corazones, pareja, aniversario, regalo digital" />
  <meta name="robots" content="index, follow" />

  <style>
    /* style.css */
    body {
        margin: 0;
        padding: 0;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        background: #fcfcfc;
    }

    #fireworks-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        display: block;
        z-index: 1;
        pointer-events: none;
    }

    #center-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 5rem;
        color: #e60026;
        font-family: 'Arial Black', Arial, sans-serif;
        text-shadow: 2px 2px 8px #ffb3b3;
        z-index: 2;
        letter-spacing: 0.5rem;
        user-select: none;
        display: flex;
        gap: 0.5rem;
        pointer-events: none;
    }

    .letter {
        opacity: 0;
        transition: opacity 0.5s;
    }

    .tree-container {
      width: 520px !important;
      height: 520px !important;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
    }

    .tree-container svg {
      width: 100%;
      height: 100%;
      display: block;
    }

    .tree-container svg path {
      transition: fill-opacity 0.5s, stroke-dashoffset 1.2s;
    }

    .tree-container svg.move-and-scale {
      transition: transform 1.2s cubic-bezier(.77,0,.18,1);
      transform: translateX(200px) scale(1.35);
    }

    .dedication-text {
      position: absolute;
      top: 50%;
      left: 3%;
      right: auto;
      transform: translateY(-50%);
      min-width: 320px;
      max-width: 600px;
      width: 60rem;
      font-size: 1.5rem;
      color: #050505;
      font-family: 'Courier New', Courier, monospace;
      white-space: pre-line;
      z-index: 3;
      opacity: 0;
      pointer-events: none;
      max-height: 90vh;
      overflow: visible;
      padding: 1em 1.5em 1em 1em;
      background: rgba(255,255,255,0.92);
      border-radius: 0.7em;
      box-shadow: 0 2px 16px #e6002611;
      transition: max-width 0.4s, min-width 0.4s, width 0.4s;
    }

    .dedication-text.typing {
      opacity: 1;
      animation: fadeInText 0.6s;
    }

    @keyframes fadeInText {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    #floating-objects {
      position: fixed;
      left: 0; top: 0;
      width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 10;
    }

    .floating-petal {
      position: absolute;
      will-change: transform, opacity;
      opacity: 0.85;
      pointer-events: none;
      width: 24px; height: 32px;
      background: radial-gradient(ellipse at 60% 30%, #ffd6e0 60%, #ff69b4 100%);
      border-radius: 60% 40% 60% 40% / 60% 60% 40% 40%;
    }

    .signature {
      position: relative;
      top: auto;
      left: auto;
      bottom: auto;
      margin-top: 1.5em;
      margin-left: 0;
      display: block;
      font-family: 'Dancing Script', 'Pacifico', cursive, sans-serif;
      font-size: 2.2rem;
      color: #e60026;
      opacity: 0;
      z-index: 5;
      white-space: pre;
      pointer-events: none;
      transition: opacity 0.7s;
    }

    .signature.visible {
      opacity: 1;
      animation: signature-draw 2.2s steps(24) forwards;
    }

    @keyframes signature-draw {
      from { clip-path: inset(0 100% 0 0); }
      to   { clip-path: inset(0 0 0 0); }
    }

    .countdown {
      position: fixed;
      left: 50%;
      bottom: 3%;
      transform: translateX(-50%);
      font-family: 'Courier New', Courier, monospace;
      font-size: 1.6rem;
      color: #333;
      background: #fff8;
      padding: 0.4em 1em;
      border-radius: 1em;
      z-index: 6;
      box-shadow: 0 2px 8px #e6002611;
      pointer-events: none;
      letter-spacing: 0.05em;
      min-width: 220px;
      text-align: center;
      transition: opacity 0.8s cubic-bezier(.77,0,.18,1), transform 0.8s cubic-bezier(.77,0,.18,1);
      opacity: 0;
      transform: translateX(-50%) translateY(30px);
    }

    .countdown.visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    @media (max-width: 700px) {
      .dedication-text {
        left: 50%;
        right: auto;
        top: 8%;
        transform: translateX(-50%) translateY(0);
        min-width: 0;
        max-width: 95vw;
        width: 95vw;
        font-size: 1.1rem;
        padding: 0.7em 0.7em 0.7em 0.7em;
      }
      .signature {
        font-size: 1.3rem;
      }
    }

    /* style.mobile.css */
    body {
      font-size: 16px;
    }

    .tree-container {
      width: 92vw !important;
      height: 62vw !important;
      max-width: 98vw;
      max-height: 80vw;
      min-width: 180px;
      min-height: 180px;
      position: absolute;
      top: 48%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2;
    }

    .tree-container svg {
      width: 100%;
      height: 100%;
      display: block;
    }

    .tree-container svg.move-and-scale {
      transition: transform 1.2s cubic-bezier(.77,0,.18,1);
      transform: translateY(60px) scale(1.18);
    }

    .dedication-text {
      position: absolute;
      top: 7vw;
      left: 50%;
      transform: translateX(-50%);
      max-width: 92vw;
      font-size: 1.05rem;
      text-align: center;
      color: #000000;
      font-family: 'Courier New', Courier, monospace;
      white-space: pre-line;
      z-index: 3;
      opacity: 0;
      pointer-events: none;
    }

    .signature {
      position: static;
      display: block;
      margin: 2.2em auto 0 auto;
      left: auto;
      bottom: auto;
      transform: none;
      font-size: 1.25rem;
      color: #e60026;
      opacity: 0;
      z-index: 5;
      white-space: pre;
      pointer-events: none;
      transition: opacity 0.7s;
      text-align: center;
    }

    @media (max-width: 700px) {
      .signature {
        position: static;
        display: block;
        margin: 2.2em auto 0 auto;
        left: auto;
        bottom: auto;
        transform: none;
        font-size: 1.25rem;
        text-align: center;
      }
    }

    .countdown {
      position: fixed;
      left: 50%;
      bottom: 10vw;
      transform: translateX(-50%);
      font-size: 0.98rem;
      min-width: 60vw;
      max-width: 92vw;
      text-align: center;
      padding: 0.5em 0.7em;
      border-radius: 1em;
      background: #fff8;
      box-shadow: 0 2px 8px #e6002611;
      z-index: 6;
      pointer-events: none;
      letter-spacing: 0.05em;
      transition: opacity 0.8s cubic-bezier(.77,0,.18,1), transform 0.8s cubic-bezier(.77,0,.18,1);
      opacity: 0;
      transform: translateX(-50%) translateY(30px);
    }

    .countdown.visible {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* Ajusta los pétalos flotantes */
    .floating-petal {
      width: 13px;
      height: 18px;
    }

    /* Animación corazones */
    .animated-heart {
      transform-origin: center;
      animation: beat 1s infinite;
    }
    @keyframes beat {
      0%, 100% { transform: scale(1); }
      20% { transform: scale(1.1); }
      40% { transform: scale(0.95); }
      60% { transform: scale(1.08); }
      80% { transform: scale(1); }
    }
  </style>
</head>
<body>

  <div id="floating-objects"></div>
  <div class="dedication-text" id="dedication-text">
    <div class="signature" id="signature"></div>
  </div>
  <div class="countdown" id="countdown"></div>

  <div class="tree-container" id="tree-container">
    <!-- SVG embebido -->
    <svg height="800px" width="800px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve">
      <path style="fill:#734B46;"
        d="M315.475,225.868c0,0-57.165,80.079,0,210.472H196.525c57.165-130.393,0-210.472,0-210.472h23.387
				l17.008,48.94l6.378-95.713h17.717l9.921,70.158l42.52-46.771L315.475,225.868z" />
      <path style="fill:#5B3836;"
        d="M315.475,225.868l-2.02-23.385l-42.52,46.771l-9.921-70.158h-5.587v257.243h60.049
				C258.31,305.945,315.475,225.868,315.475,225.868z" />
      <path style="fill:#FC6F58;"
        d="M199.973,154.215c0-11.807,9.456-21.378,21.118-21.378c11.662,0,21.118,9.571,21.118,21.378
				c0-11.807,9.456-21.378,21.118-21.378c11.662,0,21.118,9.571,21.118,21.378c0,20.442-42.236,44.896-42.236,44.896
				S199.973,175.811,199.973,154.215z" />
      <g>
        <path style="fill:#F4E3C3;"
          d="M145.627,222.42c-7.697-8.954-6.766-22.375,2.077-29.979c8.844-7.602,22.254-6.508,29.951,2.446
					c-7.697-8.954-6.766-22.375,2.077-29.979c8.844-7.602,22.254-6.508,29.951,2.446c13.326,15.503-2.762,61.578-2.762,61.578
					S159.704,238.795,145.627,222.42z" />
        <path style="fill:#F4E3C3;"
          d="M280.007,112.287c5.575-10.409,18.429-14.383,28.71-8.875c10.281,5.506,14.096,18.408,8.523,28.817
					c5.575-10.409,18.429-14.383,28.71-8.875c10.281,5.506,14.096,18.408,8.523,28.817c-9.652,18.022-58.428,19.635-58.428,19.635
					S269.812,131.324,280.007,112.287z" />
        <path style="fill:#F4E3C3;"
          d="M290.756,208.879c7.432-9.173,20.806-10.657,29.87-3.315c9.064,7.342,10.388,20.73,2.955,29.903
					c7.432-9.173,20.806-10.657,29.87-3.315c9.064,7.342,10.388,20.73,2.955,29.903c-12.869,15.882-61.087,8.292-61.087,8.292
					S277.163,225.656,290.756,208.879z" />
      </g>
      <path style="fill:#FC6F58;"
        d="M143.463,198.958c-2.131-7.099,1.831-14.558,8.849-16.662c7.018-2.103,14.433,1.946,16.563,9.045
				c-2.131-7.099,1.831-14.558,8.849-16.662s14.433,1.946,16.563,9.045c3.687,12.29-17.311,34.607-17.311,34.607
				S147.359,211.94,143.463,198.958z" />
      <path style="fill:#F4E3C3;"
        d="M147.854,129.436c-2.131-7.099,1.831-14.558,8.849-16.662c7.018-2.103,14.433,1.946,16.563,9.045
				c-2.131-7.099,1.831-14.558,8.849-16.662c7.018-2.103,14.433,1.946,16.563,9.045c3.687,12.29-17.311,34.607-17.311,34.607
				S151.749,142.419,147.854,129.436z" />
      <g>
        <path style="fill:#C1321F;"
          d="M228.131,110.166c-2.131-7.099,1.831-14.558,8.849-16.662c7.018-2.103,14.433,1.946,16.563,9.045
					c-2.131-7.099,1.831-14.558,8.849-16.662c7.018-2.103,14.433,1.946,16.563,9.045c3.687,12.29-17.311,34.607-17.311,34.607
					S232.027,123.151,228.131,110.166z" />
        <path style="fill:#C1321F;"
          d="M162.864,292.717c-6.87-2.782-10.206-10.542-7.452-17.33c2.753-6.789,10.554-10.035,17.422-7.252
            c-6.87-2.782-10.206-10.542-7.452-17.33c2.753-6.789,10.554-10.035,17.422-7.252c11.893,4.818,16.15,35.166,16.15,35.166
            S175.428,297.806,162.864,292.717z"/>
        <path style="fill:#C1321F;"
          d="M199.687,223.944c-2.131-7.099,1.831-14.558,8.849-16.662c7.018-2.103,14.433,1.946,16.563,9.045
            c-2.131-7.099,1.831-14.558,8.849-16.662s14.433,1.946,16.563,9.045c3.687,12.29-17.311,34.607-17.311,34.607
            S203.583,236.928,199.687,223.944z"/>
        <path style="fill:#C1321F;"
          d="M357.981,169.91c5.665-4.779,14.086-4.11,18.806,1.491c4.722,5.601,3.956,14.015-1.71,18.794
            c5.665-4.779,14.086-4.11,18.806,1.491c4.722,5.601,3.956,14.015-1.71,18.794c-9.809,8.273-38.64-2.117-38.64-2.117
            S347.619,178.65,357.981,169.91z"/>
      </g>
      <path style="fill:#FC6F58;"
        d="M292.404,176.175c3.415-6.577,11.452-9.173,17.953-5.798s9,11.443,5.587,18.02
          c3.415-6.577,11.452-9.173,17.953-5.797c6.501,3.375,9.001,11.443,5.587,18.02c-5.913,11.388-36.523,12.786-36.523,12.786
          S286.158,188.202,292.404,176.175z"/>
    </svg>
  </div>

  <!-- YouTube Music iframe, invisible -->
  <iframe id="ytplayer" type="text/html" width="0" height="0"
    src="https://www.youtube.com/embed/Iz7xw7c_fs8?autoplay=1&mute=1&loop=1&playlist=Iz7xw7c_fs8"
    frameborder="0" allow="autoplay" allowfullscreen></iframe>

  <script>
    // JavaScript completo unificado, ajustado para usar el SVG embebido

    // Animación y lógica para el árbol y corazones
    (function() {
      const container = document.getElementById('tree-container');
      const svg = container.querySelector('svg');
      if (!svg) return;

      // Animación de "dibujo" para todos los paths
      const allPaths = Array.from(svg.querySelectorAll('path'));
      allPaths.forEach(path => {
        path.style.stroke = '#222';
        path.style.strokeWidth = '2.5';
        path.style.fillOpacity = '0';
        const length = path.getTotalLength();
        path.style.strokeDasharray = length;
        path.style.strokeDashoffset = length;
        path.style.transition = 'none';
      });

      // Forzar reflow y luego animar
      setTimeout(() => {
        allPaths.forEach((path, i) => {
          path.style.transition = `stroke-dashoffset 1.2s cubic-bezier(.77,0,.18,1) ${i * 0.08}s, fill-opacity 0.5s ${0.9 + i * 0.08}s`;
          path.style.strokeDashoffset = 0;
          setTimeout(() => {
            path.style.fillOpacity = '1';
            path.style.stroke = '';
            path.style.strokeWidth = '';
          }, 1200 + i * 80);
        });

        // Después de la animación, agranda y mueve el SVG
        const totalDuration = 1200 + (allPaths.length - 1) * 80 + 500;
        setTimeout(() => {
          svg.classList.add('move-and-scale');
          // Mostrar texto, pétalos y cuenta regresiva
          setTimeout(() => {
            showDedicationText();
            startFloatingObjects();
            showCountdown();
            // Ya no usamos audio, la música está en iframe
          }, 1200);
        }, totalDuration);
      }, 50);

      // Añadir animación a corazones (paths con colores específicos)
      const heartPaths = allPaths.filter(el => {
        const style = el.getAttribute('style') || '';
        return style.includes('#FC6F58') || style.includes('#C1321F');
      });
      heartPaths.forEach(path => {
        path.classList.add('animated-heart');
      });
    })();

    // Función para obtener parámetros URL
    function getURLParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name);
    }

    // Mostrar texto de dedicatoria con efecto máquina de escribir
    function showDedicationText() {
      let text = getURLParam('text');
      if (!text) {
        text = `Para el amor de mi vida:\n\nDesde el primer momento supe que eras tú. Tu sonrisa, tu voz, tu forma de ser… todo en ti me hace sentir en casa.\n\nGracias por acompañarme en cada paso, por entenderme incluso en silencio, y por llenar mis días de amor.\n\nTe amo más de lo que las palabras pueden expresar.`;
      } else {
        text = decodeURIComponent(text).replace(/\\n/g, '\n');
      }
      const container = document.getElementById('dedication-text');
      container.classList.add('typing');
      let i = 0;
      function type() {
        if (i <= text.length) {
          container.textContent = text.slice(0, i);
          i++;
          setTimeout(type, text[i - 2] === '\n' ? 350 : 45);
        } else {
          setTimeout(showSignature, 600);
        }
      }
      type();
    }

    // Mostrar firma animada
    function showSignature() {
      const dedication = document.getElementById('dedication-text');
      let signature = dedication.querySelector('#signature');
      if (!signature) {
        signature = document.createElement('div');
        signature.id = 'signature';
        signature.className = 'signature';
        dedication.appendChild(signature);
      }
      let firma = getURLParam('firma');
      signature.textContent = firma ? decodeURIComponent(firma) : "CREADOR , VIC_PERSI";
      signature.classList.add('visible');
    }

    // Objetos flotantes animados (pétalos)
    function startFloatingObjects() {
      const container = document.getElementById('floating-objects');
      let count = 0;
      function spawn() {
        let el = document.createElement('div');
        el.className = 'floating-petal';
        el.style.left = `${Math.random() * 90 + 2}%`;
        el.style.top = `${100 + Math.random() * 10}%`;
        el.style.opacity = 0.7 + Math.random() * 0.3;
        container.appendChild(el);

        const duration = 6000 + Math.random() * 4000;
        const drift = (Math.random() - 0.5) * 60;
        setTimeout(() => {
          el.style.transition = `transform ${duration}ms linear, opacity 1.2s`;
          el.style.transform = `translate(${drift}px, -110vh) scale(${0.8 + Math.random() * 0.6}) rotate(${Math.random() * 360}deg)`;
          el.style.opacity = 0.2;
        }, 30);

        setTimeout(() => {
          if (el.parentNode) el.parentNode.removeChild(el);
        }, duration + 2000);

        if (count++ < 32) setTimeout(spawn, 350 + Math.random() * 500);
        else setTimeout(spawn, 1200 + Math.random() * 1200);
      }
      spawn();
    }

    // Cuenta regresiva para aniversario
    function showCountdown() {
      const container = document.getElementById('countdown');
      let startParam = getURLParam('start');
      let eventParam = getURLParam('event');
      let startDate = startParam ? new Date(startParam + 'T00:00:00') : new Date('2024-08-03T00:00:00');
      let eventDate = eventParam ? new Date(eventParam + 'T00:00:00') : new Date('2025-08-03T00:00:00');

      function update() {
        const now = new Date();
        let diff = now - startDate;
        let days = Math.floor(diff / (1000 * 60 * 60 * 24));
        let eventDiff = eventDate - now;
        let eventDays = Math.max(0, Math.floor(eventDiff / (1000 * 60 * 60 * 24)));
        let eventHours = Math.max(0, Math.floor((eventDiff / (1000 * 60 * 60)) % 24));
        let eventMinutes = Math.max(0, Math.floor((eventDiff / (1000 * 60)) % 60));
        let eventSeconds = Math.max(0, Math.floor((eventDiff / 1000) % 60));

        container.innerHTML =
          `Llevamos juntos: <b>${days}</b> días<br>` +
          `Nuestro aniversario: <b>${eventDays}d ${eventHours}h ${eventMinutes}m ${eventSeconds}s</b>`;
        container.classList.add('visible');
      }
      update();
      setInterval(update, 1000);
    }
  </script>

</body>
</html>
    </head>
<body>
    <audio id="bg-music" loop autoplay>
        <source src="te espere.mp3" type="audio/mpeg">
        Tu navegador no soporta el elemento de audio.
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const body = document.body;
            const audio = document.getElementById('bg-music');
            
            // Configurar audio
            audio.volume = 0.4;
            audio.play().catch(e => console.log("La reproducción automática no está permitida"));

 document.addEventListener('click', function() {
                audio.play().catch(e => console.log("Audio no pudo reproducirse"));
            }, { once: true });
        });
    </script>
</body>
</html>
